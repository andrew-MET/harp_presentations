{
  "hash": "bef08270f71a2ecc7cb339b69f810dca",
  "result": {
    "markdown": "---\ntitle: \"Probabilistic Verification\"\nauthor: \"Andrew Singleton\"\nformat: \n  revealjs:\n    theme: simple\n    embed-resources: true\n---\n\n::: {.cell}\n\n:::\n\n\n\n# Summary Scores\n\n##\n\n- Hexbins\n- Bias\n- Spread :: Skill (RMSE)\n- Spread :: Skill (STDE)\n- Rank Histogram\n- Continuous Rank Probability Score (CRPS)\n\n# Hexbins\n\n\n::: {.cell}\n\n:::\n\n\n\n## Directly compare forecasts & observations\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Like a \"scatter\" plot\n- Hexagons are equally distributed in all directions\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-3-1.png){width=768}\n:::\n:::\n\n:::\n\n::::\n\n## Distribution of biases\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n<h5>Too cool when it's warm</h5>\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-4-1.png){width=768}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n<h5>Too warm when it's cooler</h5>\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n:::\n\n::::\n\n# Bias\n\n## Bias of the ensemble mean\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n## Bias of individual members\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\n## Improved bias?\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n## Improved bias?\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n# Spread :: Skill (RMSE)\n\n##\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n<h5>What is skill (RMSE)?</h5>\n\n$\\sqrt{\\frac{1}{N}\\sum\\limits_{1}^{N} \\left(\\overline{f} - o\\right)^{2}}$\n:::\n\n::: {.column width=\"50%\"}\n<h5>What is spread?</h5>\n\n$\\sqrt{\\frac{1}{N}\\sum\\limits_{1}^{N} \\left(Var\\left(f\\right)\\right)}$\n:::\n\n::::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-10-1.png){width=960}\n:::\n:::\n\n\n##\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n<h5>What is skill (STDE)?</h5>\n\n$\\sqrt{\\frac{1}{NM-1}\\sum\\limits_{i=1}^{NM} \\left(f_{i} - o\\right)^{2}}$\n:::\n\n::: {.column width=\"50%\"}\n<h5>What is spread?</h5>\n\n$\\sqrt{\\frac{1}{N}\\sum\\limits_{1}^{N} \\left(Var\\left(f\\right)\\right)}$\n:::\n\n::::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n## Impact of bias\n\n<h5>RMSE</h5>\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n## Impact of bias\n\n<h5>STDE</h5>\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-13-1.png){width=960}\n:::\n:::\n\n\n# Rank histograms\n\n## Rank observations by ensemble member\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Shows dispersion of ensemble\n- Aiming for normalized frequency of 1 for each rank\n:::\n\n\n::: {.cell}\n\n:::\n\n\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n:::\n\n::::\n\n# Continuous Rank Probability Score (CRPS)\n\n## Mean difference between ensemble CDF and observations\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Area between forecast CDF and observed step function\n- Averaged over each case\n- Equivalent to mean absolute error for deterministic\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n:::\n\n::::\n\n## Bias is a component of CRPS\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-17-1.png){width=960}\n:::\n:::\n\n\n## Impact of bias\n\n- 1$^\\circ$ positive bias, 1$^\\circ$ negative bias\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n# Threshold Scores\n\n# Brier Score\n\n## Mean Square Error in probability space for a given threshold\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- $BS=\\frac{1}{N}\\sum\\limits_{i=1}^{N}\\left(f_i-o_i\\right)^2$\n- Range [0, $\\infty$]\n- Perfect score = 0\n- Sensitive to event rarity\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n:::\n\n::::\n\n## Brier Skill score\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Compares Brier Score with a reference (usually sample climatology)\n- $BSS=1-\\frac{BS}{BS_{ref}}$\n- Range [$-\\infty$, 1]\n- $<=0$ -> No skill\n- 1 -> Perfect skill\n- Reduces to $-\\infty$ when there are no events\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n:::\n\n::::\n\n# Reliability\n\n## Compares forecast probability with observed frequency\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- With what frequency did the event occur for a given forecast probability?\n- Observed frequency should equal forecast probability\n- Easy to interpret and communicate\n- Difficult to reduce to a single number\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-21-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::::\n\n# Relative / Receiver Operating Characteristic\n\n## Compares Hit Rate with False Alarm Rate\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- Given that the event occurred, how did the forecast do for each probability?\n- $HR=\\frac{H}{H+M}$\n- $FAR=\\frac{FA}{FA + CR}$\n- Top left is best\n- Can be reduced to area under the ROC curve\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n:::\n\n::::\n\n## Area under ROC curve summarises\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n# Brier Score Decomposition\n\n## Reliability, Resolution and Uncertainty\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- $BS_{rel}-BS_{res}+BS_{unc}$\n- Perfect $BS_{rel} = 0$\n- Perfect $BS_{res}=BS_{unc}$\n- $BS_{unc}$ is a function of the observations only\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\n:::\n\n::::\n\n# Economic value\n\n## User oriented score\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n- For what cost/loss ratios is the ensemble better than climatology\n- Usually sample climatology\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](probabilistic-verification_files/figure-revealjs/unnamed-chunk-25-1.png){width=960}\n:::\n:::\n\n:::\n\n::::\n",
    "supporting": [
      "probabilistic-verification_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}